{"version":3,"file":"runtime.js","sources":["uni_modules/tuniaoui-vue3/utils/vue/props/runtime.ts"],"sourcesContent":["/* eslint-disable eslint-comments/no-unlimited-disable */\nimport { warn } from 'vue'\nimport { fromPairs } from '../../../libs/lodash'\nimport { isObject } from '../../types'\nimport { hasOwn } from '../../objects'\n\nimport type { PropType } from 'vue'\nimport type {\n  IfNativePropType,\n  IfTnProp,\n  NativePropType,\n  TnProp,\n  TnPropConvert,\n  TnPropFinalized,\n  TnPropInput,\n  TnPropMergeType,\n} from './types'\n\nexport const tnPropKey = '__tnPropKey'\n\nexport const definePropType = <T>(val: any): PropType<T> => val\n\nexport const isTnProp = (val: unknown): val is TnProp<any, any, any> =>\n  isObject(val) && !!(val as any)[tnPropKey]\n\n/**\n  * 生成 prop，能更好地优化类型\n  * @example\n  // limited options\n  // the type will be PropType<'light' | 'dark'>\n  buildProp({\n    type: String,\n    values: ['light', 'dark'],\n  } as const)\n  * @example\n  // limited options and other types\n  // the type will be PropType<'small' | 'large' | number>\n  buildProp({\n    type: [String, Number],\n    values: ['small', 'large'],\n    validator: (val: unknown): val is number => typeof val === 'number',\n  } as const)\n*/\n// eslint-disable-next-line eslint-comments/no-duplicate-disable\n// eslint-disable-next-line eslint-comments/no-unlimited-disable\n/* eslint-disable */\nexport const buildProp = <\n  Type = never,\n  Value = never,\n  Validator = never,\n  Default extends TnPropMergeType<Type, Value, Validator> = never,\n  Required extends boolean = false\n>(\n  prop: TnPropInput<Type, Value, Validator, Default, Required>,\n  key?: string\n): TnPropFinalized<Type, Value, Validator, Default, Required> => {\n  if (!isObject(prop) || isTnProp(prop)) return prop as any\n\n  const { values, required, default: defaultValue, type, validator } = prop\n\n  const _validator =\n    values || validator\n      ? (val: unknown) => {\n          let valid = false\n          let allowedValues: unknown[] = []\n\n          if (values) {\n            allowedValues = Array.from(values)\n            if (hasOwn(prop, 'default')) {\n              allowedValues.push(defaultValue)\n            }\n            valid ||= allowedValues.includes(val)\n          }\n          if (validator) valid ||= validator(val)\n\n          if (!valid && allowedValues.length > 0) {\n            const allowValuesText = [...new Set(allowedValues)]\n              .map((value) => JSON.stringify(value))\n              .join(', ')\n            warn(\n              `Invalid prop: validation failed${\n                key ? ` for prop \"${key}\"` : ''\n              }. Expected one of [${allowValuesText}], got value ${JSON.stringify(\n                val\n              )}.`\n            )\n          }\n          return valid\n        }\n      : undefined\n\n  const tnProp: any = {\n    type,\n    required: !!required,\n    validator: _validator,\n    [tnPropKey]: true,\n  }\n  if (hasOwn(prop, 'default')) tnProp.default = defaultValue\n  return tnProp\n}\n\nexport const buildProps = <\n  Props extends Record<\n    string,\n    | { [tnPropKey]: true }\n    | NativePropType\n    | TnPropInput<any, any, any, any, any>\n  >\n>(\n  props: Props\n): {\n  [K in keyof Props]: IfTnProp<\n    Props[K],\n    Props[K],\n    IfNativePropType<Props[K], Props[K], TnPropConvert<Props[K]>>\n  >\n} =>\n  fromPairs(\n    Object.entries(props).map(([key, option]) => [\n      key,\n      buildProp(option as any, key),\n    ])\n  ) as any\n/* eslint-enable */\n"],"names":["isObject","hasOwn","warn","fromPairs","__read"],"mappings":";;;;AAkBO,MAAM,YAAY;AAEZ,MAAA,iBAAiB,CAAI,QAAQ;AAAkB,SAAA;AAAG;AAExD,MAAM,WAAW,CAAC,QAAY;AACnC,SAAAA,cAAAA,SAAS,GAAG,KAAK,CAAC,CAAE,IAAY,SAAS;AAAzC;AAuBW,MAAA,YAAY,CAOvB,MACA,QAAY;AAEZ,MAAI,CAACA,cAAAA,SAAS,IAAI,KAAK,SAAS,IAAI;AAAG,WAAO;AAEtC,QAAA,SAA6D,KAAvD,QAAE,WAAqD,KAA7C,UAAW,eAAkC,KAAtB,SAAE,OAAoB,KAAI,MAAlB,YAAc,KAAI;AAEzE,QAAM,aACJ,UAAU,YACN,CAAC,QAAY;AACX,QAAI,QAAQ;AACZ,QAAI,gBAA2B,CAAA;AAE/B,QAAI,QAAQ;AACV,sBAAgB,MAAM,KAAK,MAAM;AACjC,UAAIC,cAAM,OAAC,MAAM,SAAS,GAAG;AAC3B,sBAAc,KAAK,YAAY;AAAA,MAChC;AACD,gBAAA,QAAU,cAAc,SAAS,GAAG;AAAA,IACrC;AACD,QAAI;AAAW,gBAAA,QAAU,UAAU,GAAG;AAEtC,QAAI,CAAC,SAAS,cAAc,SAAS,GAAG;AACtC,YAAM,kBAAkB,CAAC,GAAG,IAAI,IAAI,aAAa,CAAC,EAC/C,IAAI,CAAC,UAAK;AAAK,eAAA,KAAK,UAAU,KAAK;AAAA,OAAC,EACpC,KAAK,IAAI;AACZC,oBAAI,KACF,kCACE,MAAM,cAAc,GAAG,MAAM,EAC/B,sBAAsB,eAAe,gBAAgB,KAAK,UACxD,GAAG,CACJ,GAAG;AAAA,IAEP;AACD,WAAO;AAAA,EACR,IACD;AAEN,QAAM,SAAc;AAAA,IAClB;AAAA,IACA,UAAU,CAAC,CAAC;AAAA,IACZ,WAAW;AAAA,IACX,CAAC,SAAS,GAAG;AAAA;AAEf,MAAID,cAAM,OAAC,MAAM,SAAS;AAAG,WAAO,UAAU;AAC9C,SAAO;AACT;AAEO,MAAM,aAAa,CAQxB,UAAY;AAQZ,SAAAE,+CAAAA,UACE,OAAO,QAAQ,KAAK,EAAE,IAAI,CAAC,OAAa;AAAb,QAAA,KAAAC,cAAAA,eAAC,MAAG,GAAA,CAAA,GAAE,SAAM,GAAA,CAAA;AAAM,WAAA;AAAA,MAC3C;AAAA,MACA,UAAU,QAAe,GAAG;AAAA,IAC7B;AAAA,EAAA,CAAA,CAAC;AAJJ;;;;"}