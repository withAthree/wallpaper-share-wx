{"code":"import { __awaiter } from \"tslib\";\nimport { computed, getCurrentInstance, inject, nextTick, onMounted, onUnmounted, } from 'vue';\nimport { subsectionContextKey } from '../../../../tokens';\nimport { useSelectorQuery } from '../../../../hooks';\nimport { debugWarn, generateId } from '../../../../utils';\nexport const useSubsectionItem = (props, emits) => {\n    const instance = getCurrentInstance();\n    if (!instance) {\n        debugWarn('TnSubsectionItem', '请在 setup 中使用 useSubsectionItem');\n    }\n    const uid = instance.uid;\n    const subsectionContext = inject(subsectionContextKey);\n    if (!subsectionContext) {\n        debugWarn('TnSubsectionItem', '请在 TnSubsection 中使用 TnSubsectionItem');\n    }\n    const componentId = `tsi-${generateId()}`;\n    const getSelectorNodeInfo = useSelectorQuery(instance).getSelectorNodeInfo;\n    // 标记当前item是否激活\n    const active = computed(() => { return (subsectionContext === null || subsectionContext === void 0 ? void 0 : subsectionContext.activeUid) === uid; });\n    // 获取节点信息\n    const componentRectInfo = {\n        left: 0,\n        width: 0,\n    };\n    let initCount = 0;\n    const getSubsectionItemRectInfo = () => { return __awaiter(void 0, void 0, void 0, function* () {\n        try {\n            const rectInfo = yield getSelectorNodeInfo(`#${componentId}`);\n            initCount = 0;\n            componentRectInfo.left = rectInfo.left || 0;\n            componentRectInfo.width = rectInfo.width || 0;\n            // 添加item信息\n            subsectionContext === null || subsectionContext === void 0 ? void 0 : subsectionContext.addItem(Object.assign(Object.assign({}, props), { uid, element: componentRectInfo }));\n        }\n        catch (err) {\n            if (initCount > 10) {\n                initCount = 0;\n                debugWarn('TnSubsectionItem', `获取节点信息失败: ${err}`);\n                return;\n            }\n            initCount++;\n            setTimeout(() => {\n                getSubsectionItemRectInfo();\n            }, 150);\n        }\n    }); };\n    // item点击事件\n    const itemClickEvent = () => {\n        if ((subsectionContext === null || subsectionContext === void 0 ? void 0 : subsectionContext.disabled) || props.disabled)\n            return;\n        subsectionContext === null || subsectionContext === void 0 ? void 0 : subsectionContext.setActiveItem(uid);\n        emits('click', props.title);\n    };\n    onMounted(() => {\n        nextTick(() => {\n            getSubsectionItemRectInfo();\n        });\n    });\n    onUnmounted(() => {\n        subsectionContext === null || subsectionContext === void 0 ? void 0 : subsectionContext.removeItem(uid);\n    });\n    return {\n        componentId,\n        active,\n        itemClickEvent,\n    };\n};\n//# sourceMappingURL=D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/subsection/src/composables/use-subsection-item.js.map","references":["D:/Development/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/tokens/index.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/hooks/index.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/utils/index.ts","D:/Development/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/subsection/src/subsection-item.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/subsection/src/types.ts"],"uniExtApis":[],"map":"{\"version\":3,\"file\":\"use-subsection-item.js\",\"sourceRoot\":\"\",\"sources\":[\"use-subsection-item.ts\"],\"names\":[],\"mappings\":\"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\"}"}
