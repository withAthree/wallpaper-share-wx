{"code":"import { computed, getCurrentInstance, nextTick, watch } from 'vue';\nimport { debugWarn, isBoolean, isPromise } from '../../../../utils';\nimport { CHANGE_EVENT, UPDATE_MODEL_EVENT } from '../../../../constants';\nimport { useFormItem } from '../../../form';\nimport { useSwitchCommonProps } from './use-switch-common-props';\nexport const useSwitch = (props) => {\n    const emit = getCurrentInstance().emit;\n    const formItem = useFormItem().formItem;\n    const disabled = useSwitchCommonProps(props).disabled;\n    // 判断是否为选中状态\n    const selected = computed(() => { return props.modelValue === props.activeValue; });\n    // 处理切换事件\n    const handleSwitch = () => {\n        const value = props.modelValue === props.activeValue\n            ? props.inactiveValue\n            : props.activeValue;\n        emit(UPDATE_MODEL_EVENT, value);\n        nextTick(() => { return emit(CHANGE_EVENT, value); });\n    };\n    // switch按钮的点击切换事件\n    const switchClickEvent = () => {\n        if (disabled.value || props.loading)\n            return;\n        const beforeChange = props.beforeChange;\n        if (!beforeChange) {\n            handleSwitch();\n            return;\n        }\n        const shouldChange = beforeChange();\n        const isPromiseOrBool = [\n            isPromise(shouldChange),\n            isBoolean(shouldChange),\n        ].includes(true);\n        if (!isPromiseOrBool) {\n            throw new Error('[TnSwitch] beforeChange 返回值必须是 Promise 或者 boolean');\n        }\n        if (isPromise(shouldChange)) {\n            shouldChange\n                .then((res) => {\n                if (res)\n                    handleSwitch();\n            })\n                .catch((err) => {\n                // eslint-disable-next-line no-console\n                uni.__f__('warn', 'at uni_modules/tuniaoui-vue3/components/switch/src/composables/use-switch.ts:61', `[TnSwitch] some error occured: ${err}`);\n            });\n        }\n        else if (shouldChange) {\n            handleSwitch();\n        }\n    };\n    watch(() => { return props.modelValue; }, () => {\n        var _a;\n        if (props.validateEvent) {\n            (_a = formItem === null || formItem === void 0 ? void 0 : formItem.validate) === null || _a === void 0 ? void 0 : _a.call(formItem, 'change').catch((err) => {\n                debugWarn(err);\n            });\n        }\n    });\n    return {\n        selected,\n        switchClickEvent,\n    };\n};\n//# sourceMappingURL=D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/switch/src/composables/use-switch.js.map","references":["D:/DEV/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/utils/index.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/constants/index.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/form/index.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/switch/src/composables/use-switch-common-props.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/switch/src/switch.ts"],"uniExtApis":[],"map":"{\"version\":3,\"file\":\"use-switch.js\",\"sourceRoot\":\"\",\"sources\":[\"use-switch.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,QAAQ,EAAE,kBAAkB,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,KAAK,CAAA;AACnE,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,mBAAmB,CAAA;AACnE,OAAO,EAAE,YAAY,EAAE,kBAAkB,EAAE,MAAM,uBAAuB,CAAA;AACxE,OAAO,EAAE,WAAW,EAAE,MAAM,eAAe,CAAA;AAC3C,OAAO,EAAE,oBAAoB,EAAE,MAAM,2BAA2B,CAAA;AAIhE,MAAM,CAAC,MAAM,SAAS,GAAG,CAAC,KAAkB;IAClC,MAAA,IAAI,GAAK,kBAAkB,EAAG,KAA1B,CAA0B;IAE9B,MAAA,QAAQ,GAAK,WAAW,EAAE,SAAlB,CAAkB;IAE1B,MAAA,QAAQ,GAAK,oBAAoB,CAAC,KAAK,CAAC,SAAhC,CAAgC;IAEhD,YAAY;IACZ,MAAM,QAAQ,GAAG,QAAQ,CACvB,QAAM,OAAA,KAAK,CAAC,UAAU,KAAK,KAAK,CAAC,WAAW,EAAtC,CAAsC,CAC7C,CAAA;IAED,SAAS;IACT,MAAM,YAAY,GAAG;QACnB,MAAM,KAAK,GACT,KAAK,CAAC,UAAU,KAAK,KAAK,CAAC,WAAW;YACpC,CAAC,CAAC,KAAK,CAAC,aAAa;YACrB,CAAC,CAAC,KAAK,CAAC,WAAW,CAAA;QAEvB,IAAI,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAA;QAC/B,QAAQ,CAAC,QAAM,OAAA,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,EAAzB,CAAyB,CAAC,CAAA;IAC3C,CAAC,CAAA;IAED,kBAAkB;IAClB,MAAM,gBAAgB,GAAG;QACvB,IAAI,QAAQ,CAAC,KAAK,IAAI,KAAK,CAAC,OAAO;YAAE,OAAM;QAEnC,MAAA,YAAY,GAAK,KAAK,aAAV,CAAU;QAC9B,IAAI,CAAC,YAAY,EAAE;YACjB,YAAY,EAAE,CAAA;YACd,OAAM;SACP;QAED,MAAM,YAAY,GAAG,YAAY,EAAE,CAAA;QAEnC,MAAM,eAAe,GAAG;YACtB,SAAS,CAAC,YAAY,CAAC;YACvB,SAAS,CAAC,YAAY,CAAC;SACxB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;QAChB,IAAI,CAAC,eAAe,EAAE;YACpB,MAAM,IAAI,KAAK,CACb,mDAAmD,CACpD,CAAA;SACF;QAED,IAAI,SAAS,CAAC,YAAY,CAAC,EAAE;YAC3B,YAAY;iBACT,IAAI,CAAC,CAAC,GAAG;gBACR,IAAI,GAAG;oBAAE,YAAY,EAAE,CAAA;YACzB,CAAC,CAAC;iBACD,KAAK,CAAC,CAAC,GAAG;gBACT,sCAAsC;gBACtC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAC,iFAAiF,EAAC,kCAAkC,GAAG,EAAE,CAAC,CAAA;YAC7I,CAAC,CAAC,CAAA;SACL;aAAM,IAAI,YAAY,EAAE;YACvB,YAAY,EAAE,CAAA;SACf;IACH,CAAC,CAAA;IAED,KAAK,CACH,QAAM,OAAA,KAAK,CAAC,UAAU,EAAhB,CAAgB,EACtB;;QACE,IAAI,KAAK,CAAC,aAAa,EAAE;YACvB,MAAA,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,QAAQ,yDAAG,QAAQ,EAAE,KAAK,CAAC,CAAC,GAAG;gBACvC,SAAS,CAAC,GAAG,CAAC,CAAA;YAChB,CAAC,CAAC,CAAA;SACH;IACH,CAAC,CACF,CAAA;IAED,OAAO;QACL,QAAQ;QACR,gBAAgB;KACjB,CAAA;AACH,CAAC,CAAA\"}"}
