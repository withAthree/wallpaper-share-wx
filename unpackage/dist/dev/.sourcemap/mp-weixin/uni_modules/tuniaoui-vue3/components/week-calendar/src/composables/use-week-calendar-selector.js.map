{"version":3,"file":"use-week-calendar-selector.js","sources":["uni_modules/tuniaoui-vue3/components/week-calendar/src/composables/use-week-calendar-selector.ts"],"sourcesContent":["import { getCurrentInstance, nextTick, onMounted, ref } from 'vue'\r\n\r\nimport { useSelectorQuery } from '../../../../hooks'\r\nimport { debugWarn, generateId } from '../../../../utils'\r\n\r\nexport const useWeekCalendarSelector = () => {\r\n  const instance = getCurrentInstance()\r\n  if (!instance) {\r\n    debugWarn('TnWeekCalendar', '请在 setup 中使用 useWeekCalendarSelector')\r\n  }\r\n\r\n  const componentDateItemId = `twcdi-${generateId()}`\r\n\r\n  const { getSelectorNodeInfo } = useSelectorQuery(instance)\r\n\r\n  // 存放日期节点容器的高度\r\n  const dateItemContainerHeight = ref<number>(0)\r\n\r\n  let initCount = 0\r\n  // 获取日期节点信息\r\n  const getDateItemNodeInfo = async () => {\r\n    try {\r\n      const nodeInfo = await getSelectorNodeInfo(`#${componentDateItemId}-0-0`)\r\n\r\n      dateItemContainerHeight.value = nodeInfo.height || 0\r\n      dateItemContainerHeight.value += uni.upx2px(16)\r\n    } catch (err) {\r\n      if (initCount > 10) {\r\n        initCount = 0\r\n        debugWarn('TnWeekCalendar', `获取日期节点信息失败：${err}`)\r\n        return\r\n      }\r\n      initCount++\r\n      setTimeout(() => {\r\n        getDateItemNodeInfo()\r\n      }, 150)\r\n    }\r\n  }\r\n\r\n  onMounted(() => {\r\n    // #ifndef APP-PLUS || H5 || MP-ALIPAY\r\n    nextTick(() => {\r\n      getDateItemNodeInfo()\r\n    })\r\n    // #endif\r\n    // #ifdef APP-PLUS || H5 || MP-ALIPAY\r\n    setTimeout(() => {\r\n      getDateItemNodeInfo()\r\n    }, 150)\r\n    // #endif\r\n  })\r\n\r\n  return {\r\n    componentDateItemId,\r\n    dateItemContainerHeight,\r\n  }\r\n}\r\n"],"names":["getCurrentInstance","debugWarn","generateId","useSelectorQuery","ref","__awaiter","uni","onMounted","nextTick"],"mappings":";;;;;;;AAKa,MAAA,0BAA0B,MAAA;AACrC,QAAM,WAAWA,cAAAA;AACjB,MAAI,CAAC,UAAU;AACbC,mDAAU,kBAAkB,sCAAsC;AAAA,EACnE;AAED,QAAM,sBAAsB,SAASC,oCAAU,WAAA,CAAE;AAEzC,QAAA,sBAAwBC,sDAAAA,iBAAiB,QAAQ;AAGzD,QAAM,0BAA0BC,kBAAY,CAAC;AAE7C,MAAI,YAAY;AAEhB,QAAM,sBAAsB,MAAA;AAAA,WAAAC,cAAA,UAAA,QAAA,QAAA,QAAA,aAAA;AAC1B,UAAI;AACF,cAAM,WAAW,MAAM,oBAAoB,IAAI,mBAAmB,MAAM;AAExE,gCAAwB,QAAQ,SAAS,UAAU;AACnD,gCAAwB,SAASC,cAAAA,MAAI,OAAO,EAAE;AAAA,MAC/C,SAAQ,KAAK;AACZ,YAAI,YAAY,IAAI;AAClB,sBAAY;AACZL,+CAAAA,UAAU,kBAAkB,cAAc,GAAG,EAAE;AAC/C;AAAA,QACD;AACD;AACA,mBAAW,MAAA;AACT;QACD,GAAE,GAAG;AAAA,MACP;AAAA,IACF,CAAA;AAAA;AAEDM,gBAAAA,UAAU,MAAA;AAERC,kBAAAA,WAAS,MAAA;AACP;IACF,CAAC;AAAA,EAOH,CAAC;AAED,SAAO;AAAA,IACL;AAAA,IACA;AAAA;AAEJ;;"}