{"version":3,"file":"index.js","sources":["uni_modules/tuniaoui-vue3/components/form/src/form.vue","uni_modules/tuniaoui-vue3/components/form/src/form-item.vue","uni_modules/tuniaoui-vue3/components/form/index.ts"],"sourcesContent":["<script lang=\"uts\" setup>\nimport { provide, reactive, toRefs, watch } from 'vue'\nimport { formContextKey } from '../../../tokens'\nimport { formEmits, formProps } from './form'\nimport { useForm, useFormCustomStyle } from './composables'\n\nconst props = defineProps(formProps)\nconst emits = defineEmits(formEmits)\n\nconst { formClass } = useFormCustomStyle()\nconst {\n  addField,\n  removeField,\n  resetFields,\n  clearValidate,\n  validate,\n  validateField,\n} = useForm(props)\n\nwatch(\n  () => props.rules,\n  () => {\n    if (props.validateOnRuleChange) validate()\n  },\n  {\n    deep: true,\n  }\n)\n\nprovide(\n  formContextKey,\n  reactive({\n    ...toRefs(props),\n    emits,\n\n    resetFields,\n    clearValidate,\n    validateField,\n    addField,\n    removeField,\n  })\n)\n\ndefineExpose({\n  /**\n   * @description 对整个表单的内容进行验证。 接收一个回调函数或返回Promise\n   */\n  validate,\n  /**\n   * @description 验证具体的某个字段\n   */\n  validateField,\n  /**\n   * @description 重置表单\n   */\n  resetFields,\n  /**\n   * @description 清除表单验证\n   */\n  clearValidate,\n})\n</script>\n\n<template>\n  <view :class=\"[formClass]\">\n    <slot />\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../../../theme-chalk/src/form.scss';\n</style>\n","<script lang=\"uts\" setup>\nimport {\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  reactive,\n  toRefs,\n  useSlots,\n} from 'vue'\nimport { formItemContextKey } from '../../../tokens'\nimport { formItemProps } from './form-item'\nimport {\n  useFormItemCustomStyle,\n  useFormItemOperation,\n  useFormSize,\n} from './composables'\n\nimport type { FormItemContext } from './types'\n\nconst props = defineProps(formItemProps)\n\nconst slots = useSlots()\n\nconst {\n  formContext,\n  validateState,\n  validateMessage,\n  hasLabel,\n  currentLabel,\n  shouldShowError,\n  isRequired,\n  resetField,\n  clearValidate,\n  validate,\n  initFieldValue,\n} = useFormItemOperation(props, slots)\nconst {\n  ns: formItemNs,\n  labelId,\n  formItemClass,\n  formItemLabelClass,\n  formItemLabelStyle,\n  formItemErrorMessageStyle,\n  initLabelContainerWidth,\n} = useFormItemCustomStyle(props, hasLabel, isRequired)\nconst _size = useFormSize(undefined, { formItem: false })\n\nconst context: FormItemContext = reactive({\n  ...toRefs(props),\n  size: _size,\n  validateState,\n  hasLabel,\n  resetField,\n  clearValidate,\n  validate,\n})\n\nonMounted(() => {\n  if (props.prop) {\n    formContext?.addField(context)\n    initFieldValue()\n  }\n  nextTick(() => {\n    initLabelContainerWidth()\n  })\n})\n\nonBeforeUnmount(() => {\n  formContext?.removeField(context)\n})\n\nprovide(formItemContextKey, context)\n\ndefineExpose({\n  /**\n   * @description 表单尺寸\n   */\n  size: _size,\n  /**\n   * @description 校验信息\n   */\n  validateMessage,\n  /**\n   * @description 校验状态\n   */\n  validateState,\n  /**\n   * @description 对表单Item的内容进行验证。 接收一个回调函数或返回Promise\n   */\n  validate,\n  /**\n   * @description 重置当前字段信息\n   */\n  resetField,\n  /**\n   * @description 清除表单字段验证\n   */\n  clearValidate,\n})\n</script>\n\n<template>\n  <view :class=\"[formItemClass]\">\n    <view :class=\"[formItemNs.e('wrapper')]\">\n      <!-- label -->\n      <view\n        v-if=\"hasLabel\"\n        :id=\"labelId\"\n        :class=\"[formItemLabelClass]\"\n        :style=\"formItemLabelStyle\"\n      >\n        <slot name=\"label\">\n          {{ currentLabel }}\n        </slot>\n      </view>\n      <!-- 表单组件 -->\n      <view :class=\"[formItemNs.e('content')]\">\n        <slot />\n      </view>\n    </view>\n    <!-- 错误信息 -->\n    <view\n      v-if=\"shouldShowError\"\n      class=\"tn-red_text\"\n      :class=\"[formItemNs.e('error-message')]\"\n      :style=\"formItemErrorMessageStyle\"\n    >\n      {{ validateMessage }}\n    </view>\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../../../theme-chalk/src/form-item.scss';\n</style>\n","import { withInstall, withNoopInstall } from '../../utils'\nimport Form from './src/form.vue'\nimport FormItem from './src/form-item.vue'\n\nexport const TnForm = withInstall(Form, {\n  FormItem,\n})\nexport default TnForm\nexport const TnFormItem = withNoopInstall(FormItem)\n\nexport * from './src/form'\nexport * from './src/form-item'\nexport * from './src/types'\n\nexport * from './src/composables'\n\nexport type { TnFormInstance, TnFormItemInstance } from './src/instance'\n"],"names":["useFormCustomStyle","useForm","watch","provide","formContextKey","reactive","toRefs","useSlots","useFormItemOperation","useFormItemCustomStyle","useFormSize","onMounted","nextTick","onBeforeUnmount","formItemContextKey","withInstall","withNoopInstall"],"mappings":";;;;;;;;;;;;;;;;;;;;AAMA,UAAM,QAAQ;AACd,UAAM,QAAQ;AAEN,UAAA,YAAcA,uFAAoB;AACpC,UAAA,KAOFC,yEAAQ,KAAK,GANf,WAAQ,GAAA,UACR,cAAW,GAAA,aACX,cAAW,GAAA,aACX,gBAAa,GAAA,eACb,WAAQ,GAAA,UACR,gBAAa,GAAA;AAGfC,kBAAAA,MACE;AAAM,aAAA,MAAM;AAAA,IAAK,GACjB,MAAA;AACE,UAAI,MAAM;AAAsB;IAClC,GACA;AAAA,MACE,MAAM;AAAA,IACP,CAAA;AAGHC,kBAAAA,QACEC,qCAAAA,gBACAC,cAAAA,SAAQ,IAAA,cAAA,OAAA,OAAA,OAAA,OAAA,CAAA,GACHC,cAAAA,OAAO,KAAK,CAAC,GAAA;AAAA,MAChB;AAAA,MAEA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAW,CAAA,CAAA,CAAA,CACX;AAGJ,aAAa;AAAA;AAAA;AAAA;AAAA,MAIX;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA,IACD,CAAA;;;;;;;;;;;;;;;;ACxCD,UAAM,QAAQ;AAEd,UAAM,QAAQC,cAAAA;AAER,UAAA,KAYFC,8EAAAA,qBAAqB,OAAO,KAAK,GAXnC,cAAW,GAAA,aACX,gBAAa,GAAA,eACb,kBAAe,GAAA,iBACf,WAAQ,GAAA,UACR,eAAY,GAAA,cACZ,kBAAe,GAAA,iBACf,aAAU,GAAA,YACV,aAAU,GAAA,YACV,kCACA,wBACA;AAEI,UAAA,KAQFC,wEAAsB,uBAAC,OAAO,UAAU,UAAU,GAPhD,aAAU,GAAA,IACd,UAAO,GAAA,SACP,gBAAa,GAAA,eACb,qBAAkB,GAAA,oBAClB,qBAAkB,GAAA,oBAClB,4BAAyB,GAAA,2BACzB;AAEF,UAAM,QAAQC,4EAAAA,YAAY,QAAW,EAAE,UAAU,MAAK,CAAE;AAExD,UAAM,UAA2BL,cAAAA,SAAQ,IAAA,cAAA,OAAA,OAAA,OAAA,OAAA,CAAA,GACpCC,cAAM,OAAC,KAAK,CAAC,GAChB;AAAA,MAAA,MAAM;AAAA,MACN;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAQ;AAGVK,kBAAAA,UAAU,MAAA;AACR,UAAI,MAAM,MAAM;AACd,wBAAW,QAAX,gBAAA,SAAA,SAAA,YAAa,SAAS,OAAO;AAC7B;MACD;AACDC,oBAAAA,WAAS,MAAA;AACP;MACF,CAAC;AAAA,IACH,CAAC;AAEDC,kBAAAA,gBAAgB,MAAA;AACd,sBAAW,QAAX,gBAAA,SAAA,SAAA,YAAa,YAAY,OAAO;AAAA,IAClC,CAAC;AAEDV,0BAAQW,qCAAAA,oBAAoB,OAAO;AAEnC,aAAa;AAAA;AAAA;AAAA;AAAA,MAIX,MAAM;AAAA;AAAA;AAAA;AAAA,MAIN;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA,IACD,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;AC/FqBC,2CAAW,YAAC,MAAM;AAAA,EACtC;AACD,CAAA;AAEyBC,2CAAAA,gBAAgB,QAAQ;"}