{"code":"import { computed, getCurrentInstance, nextTick, ref, toRef, watch } from 'vue';\nimport { CHANGE_EVENT, INPUT_EVENT, UPDATE_MODEL_EVENT, } from '../../../../constants';\nimport { useLongPress } from '../../../../hooks';\nimport { debugWarn, isEmptyVariableInDefault } from '../../../../utils';\nimport { useFormItem } from '../../../form';\nexport const useNumberBox = (props) => {\n    const emit = getCurrentInstance().emit;\n    const formItem = useFormItem().formItem;\n    // 输入框的值\n    const inputValue = ref(0);\n    // 更新输入框的值\n    watch(() => { return props.modelValue; }, (val) => {\n        const value = isEmptyVariableInDefault(val, 0);\n        inputValue.value = Math.max(props.min, Math.min(value, props.max));\n    }, {\n        immediate: true,\n    });\n    // 步进值\n    const step = computed(() => { return props.step || 1; });\n    const operationEvent = (type) => {\n        if (props.disabled)\n            return;\n        let value = inputValue.value;\n        if (type === 'minus')\n            value -= step.value;\n        else if (type === 'plus')\n            value += step.value;\n        if (value < props.min) {\n            value = props.min;\n            props.longPress && clearLongPressTimer();\n        }\n        if (value > props.max) {\n            value = props.max;\n            props.longPress && clearLongPressTimer();\n        }\n        updateNumberBoxValue(value);\n    };\n    const _a = useLongPress(operationEvent, toRef(props, 'longPress'), props.longPressInterval), clearLongPressTimer = _a.clearLongPressTimer, handleOperationEvent = _a.handleLongPressEvent;\n    // input输入框输入事件\n    const numberBoxInputEvent = (e) => {\n        const inputEventValue = e.detail.value || 0;\n        let value = Number(inputEventValue);\n        // 判断边缘值\n        if (value < props.min) {\n            value = props.min;\n        }\n        if (value > props.max) {\n            value = props.max;\n        }\n        emit(INPUT_EVENT, inputEventValue);\n        if (props.validateEvent) {\n            // eslint-disable-next-line @typescript-eslint/no-empty-function\n            formItem === null || formItem === void 0 ? void 0 : formItem.validate('input').catch(() => { });\n        }\n        // isInnerUpdate = true\n        // inputValue.value = inputEventValue\n        // nextTick(() => {\n        //   setTimeout(() => {\n        //     inputValue.value = value\n        //   }, 0)\n        // })\n        updateNumberBoxValue(value);\n    };\n    // 更新步进器的值\n    const updateNumberBoxValue = (value) => {\n        // 获取step的小数位\n        const stepValueArray = step.value.toString().split('.');\n        const decimalCount = stepValueArray.length > 1 ? stepValueArray[1].length : 0;\n        value = Number(value.toFixed(decimalCount));\n        nextTick(() => {\n            setTimeout(() => {\n                inputValue.value = value;\n            }, 0);\n        });\n        emit(UPDATE_MODEL_EVENT, value);\n        nextTick(() => {\n            var _a;\n            emit(CHANGE_EVENT, value);\n            if (props.validateEvent) {\n                (_a = formItem === null || formItem === void 0 ? void 0 : formItem.validate) === null || _a === void 0 ? void 0 : _a.call(formItem, 'change').catch((err) => {\n                    debugWarn(err);\n                });\n            }\n        });\n    };\n    return {\n        inputValue,\n        handleOperationEvent,\n        clearLongPressTimer,\n        numberBoxInputEvent,\n    };\n};\n//# sourceMappingURL=D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/number-box/src/composables/use-number-box.js.map","references":["D:/DEV/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/constants/index.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/hooks/index.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/utils/index.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/form/index.ts","D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/number-box/src/number-box.ts"],"uniExtApis":[],"map":"{\"version\":3,\"file\":\"use-number-box.js\",\"sourceRoot\":\"\",\"sources\":[\"use-number-box.ts\"],\"names\":[],\"mappings\":\"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\"}"}
