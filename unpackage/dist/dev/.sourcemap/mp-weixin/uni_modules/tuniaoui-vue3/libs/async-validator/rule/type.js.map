{"version":3,"file":"type.js","sources":["uni_modules/tuniaoui-vue3/libs/async-validator/rule/type.ts"],"sourcesContent":["import type { ExecuteRule, Value } from '../interface';\nimport { format } from '../util';\nimport required from './required';\nimport getUrlRegex from './url';\n/* eslint max-len:0 */\n\nconst pattern = {\n  // http://emailregex.com/\n  email: /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+\\.)+[a-zA-Z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]{2,}))$/,\n  // url: new RegExp(\n  //   '^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\\\S+(?::\\\\S*)?@)?(?:(?:(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}(?:\\\\.(?:[0-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))|(?:(?:[a-z\\\\u00a1-\\\\uffff0-9]+-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]+-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)*(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff]{2,})))|localhost)(?::\\\\d{2,5})?(?:(/|\\\\?|#)[^\\\\s]*)?$',\n  //   'i',\n  // ),\n  hex: /^#?([a-f0-9]{6}|[a-f0-9]{3})$/i,\n};\n\nconst types = {\n  integer(value: Value) {\n    return types.number(value) && parseInt(value, 10) === value;\n  },\n  float(value: Value) {\n    return types.number(value) && !types.integer(value);\n  },\n  array(value: Value) {\n    return Array.isArray(value);\n  },\n  regexp(value: Value) {\n    if (value instanceof RegExp) {\n      return true;\n    }\n    try {\n      return !!new RegExp(value);\n    } catch (e) {\n      return false;\n    }\n  },\n  date(value: Value) {\n    return (\n      typeof value.getTime === 'function' &&\n      typeof value.getMonth === 'function' &&\n      typeof value.getYear === 'function' &&\n      !isNaN(value.getTime())\n    );\n  },\n  number(value: Value) {\n    if (isNaN(value)) {\n      return false;\n    }\n    return typeof value === 'number';\n  },\n  object(value: Value) {\n    return typeof value === 'object' && !types.array(value);\n  },\n  method(value: Value) {\n    return typeof value === 'function';\n  },\n  email(value: Value) {\n    return (\n      typeof value === 'string' &&\n      value.length <= 320 &&\n      !!value.match(pattern.email)\n    );\n  },\n  url(value: Value) {\n    return (\n      typeof value === 'string' &&\n      value.length <= 2048 &&\n      !!value.match(getUrlRegex())\n    );\n  },\n  hex(value: Value) {\n    return typeof value === 'string' && !!value.match(pattern.hex);\n  },\n};\n\nconst type: ExecuteRule = (rule, value, source, errors, options) => {\n  if (rule.required && value === undefined) {\n    required(rule, value, source, errors, options);\n    return;\n  }\n  const custom = [\n    'integer',\n    'float',\n    'array',\n    'regexp',\n    'object',\n    'method',\n    'email',\n    'number',\n    'date',\n    'url',\n    'hex',\n  ];\n  const ruleType = rule.type;\n  if (custom.indexOf(ruleType) > -1) {\n    if (!types[ruleType](value)) {\n      errors.push(\n        format(options.messages.types[ruleType], rule.fullField, rule.type),\n      );\n    }\n    // straight typeof check\n  } else if (ruleType && typeof value !== rule.type) {\n    errors.push(\n      format(options.messages.types[ruleType], rule.fullField, rule.type),\n    );\n  }\n};\n\nexport default type;\n"],"names":["getUrlRegex","required","format"],"mappings":";;;;AAMA,MAAM,UAAU;AAAA;AAAA,EAEd,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA,EAKP,KAAK;;AAGP,MAAM,QAAQ;AAAA,EACZ,QAAQ,OAAY;AAClB,WAAO,MAAM,OAAO,KAAK,KAAK,SAAS,OAAO,EAAE,MAAM;AAAA,EACvD;AAAA,EACD,MAAM,OAAY;AAChB,WAAO,MAAM,OAAO,KAAK,KAAK,CAAC,MAAM,QAAQ,KAAK;AAAA,EACnD;AAAA,EACD,MAAM,OAAY;AAChB,WAAO,MAAM,QAAQ,KAAK;AAAA,EAC3B;AAAA,EACD,OAAO,OAAY;AACjB,QAAI,iBAAiB,QAAQ;AAC3B,aAAO;AAAA,IACR;AACD,QAAI;AACF,aAAO,CAAC,CAAC,IAAI,OAAO,KAAK;AAAA,IAC1B,SAAQ,GAAG;AACV,aAAO;AAAA,IACR;AAAA,EACF;AAAA,EACD,KAAK,OAAY;AACf,WACE,OAAO,MAAM,YAAY,cACzB,OAAO,MAAM,aAAa,cAC1B,OAAO,MAAM,YAAY,cACzB,CAAC,MAAM,MAAM,QAAO,CAAE;AAAA,EAEzB;AAAA,EACD,OAAO,OAAY;AACjB,QAAI,MAAM,KAAK,GAAG;AAChB,aAAO;AAAA,IACR;AACD,WAAO,OAAO,UAAU;AAAA,EACzB;AAAA,EACD,OAAO,OAAY;AACjB,WAAO,OAAO,UAAU,YAAY,CAAC,MAAM,MAAM,KAAK;AAAA,EACvD;AAAA,EACD,OAAO,OAAY;AACjB,WAAO,OAAO,UAAU;AAAA,EACzB;AAAA,EACD,MAAM,OAAY;AAChB,WACE,OAAO,UAAU,YACjB,MAAM,UAAU,OAChB,CAAC,CAAC,MAAM,MAAM,QAAQ,KAAK;AAAA,EAE9B;AAAA,EACD,IAAI,OAAY;AACd,WACE,OAAO,UAAU,YACjB,MAAM,UAAU,QAChB,CAAC,CAAC,MAAM,MAAMA,sDAAAA,YAAa,CAAA;AAAA,EAE9B;AAAA,EACD,IAAI,OAAY;AACd,WAAO,OAAO,UAAU,YAAY,CAAC,CAAC,MAAM,MAAM,QAAQ,GAAG;AAAA,EAC9D;;AAGG,MAAA,OAAoB,CAAC,MAAM,OAAO,QAAQ,QAAQ,YAAO;AAC7D,MAAI,KAAK,YAAY,UAAU,QAAW;AACxCC,+DAAQ,SAAC,MAAM,OAAO,QAAQ,QAAQ,OAAO;AAC7C;AAAA,EACD;AACD,QAAM,SAAS;AAAA,IACb;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAEF,QAAM,WAAW,KAAK;AACtB,MAAI,OAAO,QAAQ,QAAQ,IAAI,IAAI;AACjC,QAAI,CAAC,MAAM,QAAQ,EAAE,KAAK,GAAG;AAC3B,aAAO,KACLC,kDAAAA,OAAO,QAAQ,SAAS,MAAM,QAAQ,GAAG,KAAK,WAAW,KAAK,IAAI,CAAC;AAAA,IAEtE;AAAA,EAEF,WAAU,YAAY,OAAO,UAAU,KAAK,MAAM;AACjD,WAAO,KACLA,kDAAAA,OAAO,QAAQ,SAAS,MAAM,QAAQ,GAAG,KAAK,WAAW,KAAK,IAAI,CAAC;AAAA,EAEtE;AACH;;"}