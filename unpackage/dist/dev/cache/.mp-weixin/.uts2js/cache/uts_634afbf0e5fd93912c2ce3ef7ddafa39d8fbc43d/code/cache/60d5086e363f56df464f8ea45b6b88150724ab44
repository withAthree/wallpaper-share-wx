{"code":"import { nextTick, provide, reactive, ref, toRefs, watch } from 'vue';\nimport { CHANGE_EVENT, UPDATE_MODEL_EVENT } from '../../../../constants';\nimport { collapseContextKey } from '../../../../tokens';\nimport { useOrderedChildren } from '../../../../hooks';\nimport { isArray, isNumber } from '../../../../utils';\nexport const useCollapse = (props, emits) => {\n    const _a = useOrderedChildren(), items = _a.children, addItem = _a.addChild, removeItem = _a.removeChild;\n    // 当前已激活的面板对应的uid\n    const activeUid = ref([]);\n    const currentActiveIndex = ref();\n    // 根据modelValue更新activeUID的值\n    const updateActiveUIDWithModelValue = (val) => {\n        nextTick(() => {\n            let activeIndex;\n            if (val === undefined || val === -1) {\n                activeIndex = [];\n            }\n            else if (isNumber(val)) {\n                activeIndex = [val];\n            }\n            else {\n                activeIndex = [...val];\n            }\n            activeUid.value = items.value\n                .filter((uid, index) => { return activeIndex.includes(index); })\n                .map((item) => { return item.uid; });\n        });\n    };\n    let innerUpdate = false;\n    watch(() => { return props.modelValue; }, (val) => {\n        if (innerUpdate) {\n            innerUpdate = false;\n            return;\n        }\n        currentActiveIndex.value = val;\n        updateActiveUIDWithModelValue(val);\n    }, {\n        immediate: true,\n    });\n    // 处理CollapseItem点击事件\n    const handleItemClick = (uid) => {\n        const accordion = props.accordion;\n        // 获取对应uid对应的索引\n        const uidIndex = items.value.findIndex((item) => { return item.uid === uid; });\n        const isActive = activeUid.value.includes(uid);\n        let value;\n        // 判断是否为手风琴效果\n        if (accordion) {\n            // 判断是否已经为激活状态，如果是激活状态则取消激活，否则设置为其他面板激活\n            if (isActive) {\n                value = -1;\n            }\n            else {\n                value = uidIndex;\n            }\n        }\n        else {\n            // 判断是否存在于激活面板中，如果存在则取消激活，否则添加到激活面板中\n            if (isActive) {\n                value = currentActiveIndex.value.filter((item) => { return item !== uidIndex; });\n            }\n            else {\n                if (currentActiveIndex.value && isArray(currentActiveIndex.value)) {\n                    value = [...currentActiveIndex.value, uidIndex];\n                }\n                else {\n                    value = !currentActiveIndex.value\n                        ? [uidIndex]\n                        : [currentActiveIndex.value, uidIndex];\n                }\n            }\n        }\n        // 触发更新事件\n        innerUpdate = true;\n        currentActiveIndex.value = value;\n        emits(UPDATE_MODEL_EVENT, value);\n        updateActiveUIDWithModelValue(value);\n        nextTick(() => {\n            emits(CHANGE_EVENT, value);\n        });\n    };\n    provide(collapseContextKey, reactive(Object.assign(Object.assign({}, toRefs(props)), { items,\n        addItem,\n        removeItem,\n        activeUid,\n        handleItemClick })));\n};\n//# sourceMappingURL=D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/collapse/src/composables/use-collapse.js.map","references":["D:/Development/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/constants/index.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/tokens/index.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/hooks/index.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/utils/index.ts","D:/Development/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/tokens/index.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/collapse/src/collapse.ts"],"uniExtApis":[],"map":"{\"version\":3,\"file\":\"use-collapse.js\",\"sourceRoot\":\"\",\"sources\":[\"use-collapse.ts\"],\"names\":[],\"mappings\":\"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\"}"}
