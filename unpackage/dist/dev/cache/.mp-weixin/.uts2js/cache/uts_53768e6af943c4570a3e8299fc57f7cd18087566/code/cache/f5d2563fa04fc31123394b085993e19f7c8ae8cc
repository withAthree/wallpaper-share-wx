{"code":"/* eslint no-console:0 */\nconst formatRegExp = /%[sdj%]/g;\nexport let warning = () => { };\n// don't print warning message when in production env or node runtime\nif (typeof process !== 'undefined' &&\n    process.env &&\n    process.env.NODE_ENV !== 'production' &&\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined') {\n    warning = (type, errors) => {\n        if (typeof console !== 'undefined' &&\n            console.warn &&\n            typeof ASYNC_VALIDATOR_NO_WARNING === 'undefined') {\n            if (errors.every(e => { return typeof e === 'string'; })) {\n                uni.__f__('warn', 'at uni_modules/tuniaoui-vue3/libs/async-validator/util.ts:35', type, errors);\n            }\n        }\n    };\n}\nexport function convertFieldsError(errors) {\n    if (!errors || !errors.length)\n        return null;\n    const fields = {};\n    errors.forEach(error => {\n        const field = error.field;\n        fields[field] = fields[field] || [];\n        fields[field].push(error);\n    });\n    return fields;\n}\nexport function format(template, ...args) {\n    let i = 0;\n    const len = args.length;\n    if (typeof template === 'function') {\n        return template.apply(null, args);\n    }\n    if (typeof template === 'string') {\n        let str = template.replace(formatRegExp, x => {\n            if (x === '%%') {\n                return '%';\n            }\n            if (i >= len) {\n                return x;\n            }\n            switch (x) {\n                case '%s':\n                    return String(args[i++]);\n                case '%d':\n                    return Number(args[i++]);\n                case '%j':\n                    try {\n                        return JSON.stringify(args[i++]);\n                    }\n                    catch (_) {\n                        return '[Circular]';\n                    }\n                    break;\n                default:\n                    return x;\n            }\n        });\n        return str;\n    }\n    return template;\n}\nfunction isNativeStringType(type) {\n    return (type === 'string' ||\n        type === 'url' ||\n        type === 'hex' ||\n        type === 'email' ||\n        type === 'date' ||\n        type === 'pattern');\n}\nexport function isEmptyValue(value, type) {\n    if (value === undefined || value === null) {\n        return true;\n    }\n    if (type === 'array' && Array.isArray(value) && !value.length) {\n        return true;\n    }\n    if (isNativeStringType(type) && typeof value === 'string' && !value) {\n        return true;\n    }\n    return false;\n}\nexport function isEmptyObject(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction asyncParallelArray(arr, func, callback) {\n    const results = [];\n    let total = 0;\n    const arrLength = arr.length;\n    function count(errors) {\n        results.push(...(errors || []));\n        total++;\n        if (total === arrLength) {\n            callback(results);\n        }\n    }\n    arr.forEach(a => {\n        func(a, count);\n    });\n}\nfunction asyncSerialArray(arr, func, callback) {\n    let index = 0;\n    const arrLength = arr.length;\n    function next(errors) {\n        if (errors && errors.length) {\n            callback(errors);\n            return;\n        }\n        const original = index;\n        index = index + 1;\n        if (original < arrLength) {\n            func(arr[original], next);\n        }\n        else {\n            callback([]);\n        }\n    }\n    next([]);\n}\nfunction flattenObjArr(objArr) {\n    const ret = [];\n    Object.keys(objArr).forEach(k => {\n        ret.push(...(objArr[k] || []));\n    });\n    return ret;\n}\nexport class AsyncValidationError extends Error {\n    constructor(errors, fields) {\n        super('Async Validation Error');\n        this.errors = errors;\n        this.fields = fields;\n    }\n}\nexport function asyncMap(objArr, option, func, callback, source) {\n    if (option.first) {\n        const pending_1 = new Promise((resolve, reject) => {\n            const next = (errors) => {\n                callback(errors);\n                return errors.length\n                    ? reject(new AsyncValidationError(errors, convertFieldsError(errors)))\n                    : resolve(source);\n            };\n            const flattenArr = flattenObjArr(objArr);\n            asyncSerialArray(flattenArr, func, next);\n        });\n        pending_1.catch(e => { return e; });\n        return pending_1;\n    }\n    const firstFields = option.firstFields === true\n        ? Object.keys(objArr)\n        : option.firstFields || [];\n    const objArrKeys = Object.keys(objArr);\n    const objArrLength = objArrKeys.length;\n    let total = 0;\n    const results = [];\n    const pending = new Promise((resolve, reject) => {\n        const next = (errors) => {\n            results.push.apply(results, errors);\n            total++;\n            if (total === objArrLength) {\n                callback(results);\n                return results.length\n                    ? reject(new AsyncValidationError(results, convertFieldsError(results)))\n                    : resolve(source);\n            }\n        };\n        if (!objArrKeys.length) {\n            callback(results);\n            resolve(source);\n        }\n        objArrKeys.forEach(key => {\n            const arr = objArr[key];\n            if (firstFields.indexOf(key) !== -1) {\n                asyncSerialArray(arr, func, next);\n            }\n            else {\n                asyncParallelArray(arr, func, next);\n            }\n        });\n    });\n    pending.catch(e => { return e; });\n    return pending;\n}\nfunction isErrorObj(obj) {\n    return !!(obj && obj.message !== undefined);\n}\nfunction getValue(value, path) {\n    let v = value;\n    for (let i = 0; i < path.length; i++) {\n        if (v == undefined) {\n            return v;\n        }\n        v = v[path[i]];\n    }\n    return v;\n}\nexport function complementError(rule, source) {\n    return (oe) => {\n        let fieldValue;\n        if (rule.fullFields) {\n            fieldValue = getValue(source, rule.fullFields);\n        }\n        else {\n            fieldValue = source[oe.field || rule.fullField];\n        }\n        if (isErrorObj(oe)) {\n            oe.field = oe.field || rule.fullField;\n            oe.fieldValue = fieldValue;\n            return oe;\n        }\n        return {\n            message: typeof oe === 'function' ? oe() : oe,\n            fieldValue,\n            field: oe.field || rule.fullField,\n        };\n    };\n}\nexport function deepMerge(target, source) {\n    if (source) {\n        for (const s in source) {\n            if (source.hasOwnProperty(s)) {\n                const value = source[s];\n                if (typeof value === 'object' && typeof target[s] === 'object') {\n                    target[s] = Object.assign(Object.assign({}, target[s]), value);\n                }\n                else {\n                    target[s] = value;\n                }\n            }\n        }\n    }\n    return target;\n}\n//# sourceMappingURL=D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/libs/async-validator/util.js.map","references":["D:/DEV/Project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/libs/async-validator/interface.ts"],"uniExtApis":[],"map":"{\"version\":3,\"file\":\"util.js\",\"sourceRoot\":\"\",\"sources\":[\"util.ts\"],\"names\":[],\"mappings\":\"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\"}"}
