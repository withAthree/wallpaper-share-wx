{"version":3,"file":"use-week-calendar-selector.js","sources":["uni_modules/tuniaoui-vue3/components/week-calendar/src/composables/use-week-calendar-selector.ts"],"sourcesContent":["import { getCurrentInstance, nextTick, onMounted, ref } from 'vue'\n\nimport { useSelectorQuery } from '../../../../hooks'\nimport { debugWarn, generateId } from '../../../../utils'\n\nexport const useWeekCalendarSelector = () => {\n  const instance = getCurrentInstance()\n  if (!instance) {\n    debugWarn('TnWeekCalendar', '请在 setup 中使用 useWeekCalendarSelector')\n  }\n\n  const componentDateItemId = `twcdi-${generateId()}`\n\n  const { getSelectorNodeInfo } = useSelectorQuery(instance)\n\n  // 存放日期节点容器的高度\n  const dateItemContainerHeight = ref<number>(0)\n\n  let initCount = 0\n  // 获取日期节点信息\n  const getDateItemNodeInfo = async () => {\n    try {\n      const nodeInfo = await getSelectorNodeInfo(`#${componentDateItemId}-0-0`)\n\n      dateItemContainerHeight.value = nodeInfo.height || 0\n      dateItemContainerHeight.value += uni.upx2px(16)\n    } catch (err) {\n      if (initCount > 10) {\n        initCount = 0\n        debugWarn('TnWeekCalendar', `获取日期节点信息失败：${err}`)\n        return\n      }\n      initCount++\n      setTimeout(() => {\n        getDateItemNodeInfo()\n      }, 150)\n    }\n  }\n\n  onMounted(() => {\n    // #ifndef APP-PLUS || H5 || MP-ALIPAY\n    nextTick(() => {\n      getDateItemNodeInfo()\n    })\n    // #endif\n    // #ifdef APP-PLUS || H5 || MP-ALIPAY\n    setTimeout(() => {\n      getDateItemNodeInfo()\n    }, 150)\n    // #endif\n  })\n\n  return {\n    componentDateItemId,\n    dateItemContainerHeight,\n  }\n}\n"],"names":["getCurrentInstance","debugWarn","generateId","useSelectorQuery","ref","__awaiter","uni","onMounted","nextTick"],"mappings":";;;;;;;AAKa,MAAA,0BAA0B,MAAA;AACrC,QAAM,WAAWA,cAAAA;AACjB,MAAI,CAAC,UAAU;AACbC,mDAAU,kBAAkB,sCAAsC;AAAA,EACnE;AAED,QAAM,sBAAsB,SAASC,oCAAU,WAAA,CAAE;AAEzC,QAAA,sBAAwBC,sDAAAA,iBAAiB,QAAQ;AAGzD,QAAM,0BAA0BC,kBAAY,CAAC;AAE7C,MAAI,YAAY;AAEhB,QAAM,sBAAsB,MAAA;AAAA,WAAAC,cAAA,UAAA,QAAA,QAAA,QAAA,aAAA;AAC1B,UAAI;AACF,cAAM,WAAW,MAAM,oBAAoB,IAAI,mBAAmB,MAAM;AAExE,gCAAwB,QAAQ,SAAS,UAAU;AACnD,gCAAwB,SAASC,cAAAA,MAAI,OAAO,EAAE;AAAA,MAC/C,SAAQ,KAAK;AACZ,YAAI,YAAY,IAAI;AAClB,sBAAY;AACZL,+CAAAA,UAAU,kBAAkB,cAAc,GAAG,EAAE;AAC/C;AAAA,QACD;AACD;AACA,mBAAW,MAAA;AACT;QACD,GAAE,GAAG;AAAA,MACP;AAAA,IACF,CAAA;AAAA;AAEDM,gBAAAA,UAAU,MAAA;AAERC,kBAAAA,WAAS,MAAA;AACP;IACF,CAAC;AAAA,EAOH,CAAC;AAED,SAAO;AAAA,IACL;AAAA,IACA;AAAA;AAEJ;;"}