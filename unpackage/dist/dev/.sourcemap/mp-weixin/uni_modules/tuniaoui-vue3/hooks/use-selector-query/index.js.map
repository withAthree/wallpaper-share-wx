{"version":3,"file":"index.js","sources":["uni_modules/tuniaoui-vue3/hooks/use-selector-query/index.ts"],"sourcesContent":["import { getCurrentInstance } from 'vue'\r\nimport { debugWarn } from '../../utils'\r\n\r\nimport type { ComponentInternalInstance } from 'vue'\r\n\r\nexport const useSelectorQuery = (\r\n  instance?: ComponentInternalInstance | null\r\n) => {\r\n  let query: UniApp.SelectorQuery | null = null\r\n\r\n  if (!instance) {\r\n    instance = getCurrentInstance()\r\n  }\r\n  if (!instance) {\r\n    debugWarn('useSelectorQuery', 'useSelectorQuery必须在setup函数中使用')\r\n  }\r\n\r\n  // #ifndef MP-ALIPAY || APP-PLUS\r\n  query = uni.createSelectorQuery().in(instance)\r\n  // #endif\r\n  // #ifdef APP-PLUS\r\n  query = uni.createSelectorQuery().in((instance as any).ctx.$scope)\r\n  // #endif\r\n  // #ifdef MP-ALIPAY\r\n  query = uni.createSelectorQuery().in(null)\r\n  // #endif\r\n\r\n  const getSelectorNodeInfo = (selector: string): Promise<UniApp.NodeInfo> => {\r\n    return new Promise((resolve, reject) => {\r\n      if (query) {\r\n        query\r\n          .select(selector)\r\n          .boundingClientRect((res) => {\r\n            const selectRes: UniApp.NodeInfo = res as UniApp.NodeInfo\r\n            if (selectRes) {\r\n              resolve(selectRes)\r\n            } else {\r\n              reject(new Error(`未找到对应节点: ${selector}`))\r\n            }\r\n          })\r\n          .exec()\r\n      } else {\r\n        reject(new Error('未找到对应的SelectorQuery实例'))\r\n      }\r\n    })\r\n  }\r\n\r\n  const getSelectorNodeInfos = (\r\n    selector: string\r\n  ): Promise<UniApp.NodeInfo[]> => {\r\n    return new Promise((resolve, reject) => {\r\n      if (query) {\r\n        query\r\n          .selectAll(selector)\r\n          .boundingClientRect((res) => {\r\n            const selectRes: UniApp.NodeInfo[] = res as UniApp.NodeInfo[]\r\n            if (selectRes && selectRes.length > 0) {\r\n              resolve(selectRes)\r\n            } else {\r\n              reject(new Error(`未找到对应节点: ${selector}`))\r\n            }\r\n          })\r\n          .exec()\r\n      } else {\r\n        reject(new Error('未找到对应的SelectorQuery实例'))\r\n      }\r\n    })\r\n  }\r\n\r\n  return {\r\n    query,\r\n    getSelectorNodeInfo,\r\n    getSelectorNodeInfos,\r\n  }\r\n}\r\n"],"names":["getCurrentInstance","debugWarn","uni"],"mappings":";;;;AAKO,MAAM,mBAAmB,CAC9B,aAA2C;AAE3C,MAAI,QAAqC;AAEzC,MAAI,CAAC,UAAU;AACb,eAAWA,cAAkB,mBAAA;AAAA,EAC9B;AACD,MAAI,CAAC,UAAU;AACbC,mDAAU,oBAAoB,+BAA+B;AAAA,EAC9D;AAGD,UAAQC,cAAAA,MAAI,oBAAqB,EAAC,GAAG,QAAQ;AAS7C,QAAM,sBAAsB,CAAC,aAAgB;AAC3C,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAM;AACjC,UAAI,OAAO;AACT,cACG,OAAO,QAAQ,EACf,mBAAmB,CAAC,QAAG;AACtB,gBAAM,YAA6B;AACnC,cAAI,WAAW;AACb,oBAAQ,SAAS;AAAA,UAClB,OAAM;AACL,mBAAO,IAAI,MAAM,YAAY,QAAQ,EAAE,CAAC;AAAA,UACzC;AAAA,QACH,CAAC,EACA;MACJ,OAAM;AACL,eAAO,IAAI,MAAM,uBAAuB,CAAC;AAAA,MAC1C;AAAA,IACH,CAAC;AAAA,EACH;AAEA,QAAM,uBAAuB,CAC3B,aAAgB;AAEhB,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAM;AACjC,UAAI,OAAO;AACT,cACG,UAAU,QAAQ,EAClB,mBAAmB,CAAC,QAAG;AACtB,gBAAM,YAA+B;AACrC,cAAI,aAAa,UAAU,SAAS,GAAG;AACrC,oBAAQ,SAAS;AAAA,UAClB,OAAM;AACL,mBAAO,IAAI,MAAM,YAAY,QAAQ,EAAE,CAAC;AAAA,UACzC;AAAA,QACH,CAAC,EACA;MACJ,OAAM;AACL,eAAO,IAAI,MAAM,uBAAuB,CAAC;AAAA,MAC1C;AAAA,IACH,CAAC;AAAA,EACH;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA;AAEJ;;"}