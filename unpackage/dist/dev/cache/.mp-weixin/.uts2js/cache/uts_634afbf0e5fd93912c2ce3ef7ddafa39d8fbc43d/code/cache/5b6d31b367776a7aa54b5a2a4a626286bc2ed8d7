{"code":"import { defineComponent as _defineComponent } from 'vue';\nimport { resolveComponent as _resolveComponent, sr as _sr, unref as _unref, p as _p, o as _o, e as _e } from \"vue\";\nconst __BINDING_COMPONENTS__ = '{\"tn-notify\":{\"name\":\"_easycom_tn_notify\",\"type\":\"unknown\"},\"tn-modal\":{\"name\":\"_easycom_tn_modal\",\"type\":\"unknown\"},\"tn-icon\":{\"name\":\"_easycom_tn_icon\",\"type\":\"unknown\"},\"tn-loading\":{\"name\":\"_easycom_tn_loading\",\"type\":\"unknown\"},\"Layouts\":{\"name\":\"_unref(Layouts)\",\"type\":\"setup\"}}';\nif (!Array) {\n    const _easycom_tn_notify_1 = _resolveComponent(\"tn-notify\");\n    const _easycom_tn_modal_1 = _resolveComponent(\"tn-modal\");\n    const _easycom_tn_icon_1 = _resolveComponent(\"tn-icon\");\n    const _easycom_tn_loading_1 = _resolveComponent(\"tn-loading\");\n    (_easycom_tn_notify_1 + _easycom_tn_modal_1 + _easycom_tn_icon_1 + _easycom_tn_loading_1)();\n}\nimport _easycom_tn_notify from 'D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/notify/src/notify.vue';\nimport _easycom_tn_modal from 'D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/modal/src/modal.vue';\nimport _easycom_tn_icon from 'D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/icon/src/icon.vue';\nimport _easycom_tn_loading from 'D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/loading/src/loading.vue';\nif (!Math) {\n    (_easycom_tn_notify + _easycom_tn_modal + _easycom_tn_icon + _easycom_tn_loading + _unref(Layouts))();\n}\nimport Layouts from '@/layouts/index.uvue';\nimport AdVideo from '@/components/AdVideo.uvue';\nexport default /*#__PURE__*/ _defineComponent({\n    __name: 'index',\n    setup(__props) {\n        const downTouch = ref(false);\n        const shareTouch = ref(false);\n        const downloadLoading = ref(false);\n        const notifyRef = ref(null);\n        const modalRef = ref(null);\n        onBeforeMount(() => {\n            uni.setNavigationBarTitle({\n                title: \"1920 × 1080\"\n            });\n        });\n        const downloadFailMsg = () => {\n            var _a;\n            (_a = notifyRef.value) === null || _a === void 0 ? void 0 : _a.show(new UTSJSONObject({\n                msg: '保存失败',\n                type: 'danger',\n                position: 'center'\n            }));\n        };\n        function downloadImg(url = null) {\n            var _a;\n            const albumAuthorized = uni.getAppAuthorizeSetting().albumAuthorized;\n            if (albumAuthorized === 'authorized') {\n                // 已经获得授权，无需再次请求授权\n                const fileName = 'wallhaven-p96vd9.jpg';\n                const filePath = `${uni.env.USER_DATA_PATH}/${fileName}`;\n                // 先下载文件\n                uni.downloadFile({\n                    url,\n                    filePath,\n                    success: (res) => {\n                        downloadLoading.value = true;\n                        uni.saveImageToPhotosAlbum({\n                            filePath: res.filePath,\n                            success: () => {\n                                var _a;\n                                (_a = notifyRef.value) === null || _a === void 0 ? void 0 : _a.show(new UTSJSONObject({\n                                    msg: '保存成功',\n                                    type: 'success',\n                                    position: 'center'\n                                }));\n                                // 删除缓存\n                                const fileMgr = uni.getFileSystemManager();\n                                fileMgr.unlink({\n                                    filePath,\n                                    success: () => { uni.__f__('log', 'at pages/detail/index.uvue:84', '删除成功'); },\n                                    fail: (err) => { console.err('删除失败: ', err); }\n                                });\n                            },\n                            fail: () => {\n                                downloadFailMsg();\n                            },\n                            complete: () => {\n                                downloadLoading.value = false;\n                            }\n                        });\n                    },\n                    fail: (err) => {\n                        fail: (err = null) => { console.err('下载失败: ', err); };\n                        downloadFailMsg();\n                    },\n                });\n            }\n            else if (albumAuthorized === 'denied') {\n                (_a = modalRef.value) === null || _a === void 0 ? void 0 : _a.showModal(new UTSJSONObject({\n                    title: '未授权',\n                    content: '是否去设置相册授权',\n                    showCancel: true,\n                    confirmText: '授权',\n                    cancelText: '取消',\n                    mask: true,\n                    maskClosable: false,\n                    confirm: () => {\n                        uni.openAppAuthorizeSetting();\n                    },\n                }));\n            }\n        }\n        function handleClick() {\n            var _a;\n            (_a = modalRef.value) === null || _a === void 0 ? void 0 : _a.showModal(new UTSJSONObject({\n                title: '下载',\n                content: '观看激励视频广告获取原图',\n                showCancel: true,\n                confirmText: '获取原图',\n                cancelText: '直接下载',\n                mask: true,\n                maskClosable: false,\n                confirm: () => {\n                    // 看广告，获取原图\n                    downloadImg('https://w.wallhaven.cc/full/ex/wallhaven-exqg9w.jpg');\n                },\n                cancel: () => {\n                    // 获取压缩图\n                    downloadImg('https://th.wallhaven.cc/small/ex/exqg9w.jpg\"');\n                },\n            }));\n        }\n        return (_ctx = null, _cache = null) => {\n            const __returned__ = _e(new UTSJSONObject({\n                a: _sr(notifyRef, 'e8100d2a-1,e8100d2a-0', new UTSJSONObject({\n                    \"k\": \"notifyRef\"\n                })),\n                b: _sr(modalRef, 'e8100d2a-2,e8100d2a-0', new UTSJSONObject({\n                    \"k\": \"modalRef\"\n                })),\n                c: _p(new UTSJSONObject({\n                    name: 'folder-download-fill',\n                    color: '#fff',\n                    size: '24px'\n                })),\n                d: !_unref(downloadLoading)\n            }), !_unref(downloadLoading) ? new UTSJSONObject({}) : new UTSJSONObject({\n                e: _p(new UTSJSONObject({\n                    show: true,\n                    animation: true,\n                    mode: 'circle',\n                    color: '#fff'\n                }))\n            }), new UTSJSONObject({\n                f: _o(($event = null) => { return downTouch.value = true; }),\n                g: _o(($event = null) => { return downTouch.value = false; }),\n                h: _unref(downTouch) ? 1 : '',\n                i: _o(handleClick),\n                j: _p(new UTSJSONObject({\n                    name: 'send-fill',\n                    color: '#fff',\n                    size: '24px'\n                })),\n                k: _o(($event = null) => { return shareTouch.value = true; }),\n                l: _o(($event = null) => { return shareTouch.value = false; }),\n                m: _unref(shareTouch) ? 1 : '',\n                n: _ctx.virtualHostId,\n                o: _p(new UTSJSONObject({\n                    page: 'detail',\n                    id: _ctx.virtualHostId\n                }))\n            }));\n            return __returned__;\n        };\n    }\n});\n//# sourceMappingURL=D:/Development/project/wallpaper-share-wx/pages/detail/index.uvue?vue&type=script&setup=true&lang.uts.js.map","references":["D:/Development/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","D:/Development/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/notify/src/notify.vue.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/modal/src/modal.vue.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/icon/src/icon.vue.ts","D:/Development/project/wallpaper-share-wx/uni_modules/tuniaoui-vue3/components/loading/src/loading.vue.ts","D:/Development/project/wallpaper-share-wx/layouts/index.uvue.ts","D:/Development/project/wallpaper-share-wx/components/AdVideo.uvue.ts"],"uniExtApis":["uni.setNavigationBarTitle","uni.getAppAuthorizeSetting","uni.downloadFile","uni.saveImageToPhotosAlbum","uni.getFileSystemManager","uni.__f__","uni.openAppAuthorizeSetting"],"map":"{\"version\":3,\"file\":\"index.uvue?vue&type=script&setup=true&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"index.uvue?vue&type=script&setup=true&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
